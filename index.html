<!DOCTYPE html><html class="default" lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="IE=edge"/><title>@ryandur/sand</title><meta name="description" content="Documentation for @ryandur/sand"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="assets/style.css"/><link rel="stylesheet" href="assets/highlight.css"/><script defer src="assets/main.js"></script><script async src="assets/icons.js" id="tsd-icons-script"></script><script async src="assets/search.js" id="tsd-search-script"></script><script async src="assets/navigation.js" id="tsd-nav-script"></script></head><body><script>document.documentElement.dataset.theme = localStorage.getItem("tsd-theme") || "os";document.body.style.display="none";setTimeout(() => app?app.showPage():document.body.style.removeProperty("display"),500)</script><header class="tsd-page-toolbar"><div class="tsd-toolbar-contents container"><div class="table-cell" id="tsd-search" data-base="."><div class="field"><label for="tsd-search-field" class="tsd-widget tsd-toolbar-icon search no-caption"><svg width="16" height="16" viewBox="0 0 16 16" fill="none"><use href="assets/icons.svg#icon-search"></use></svg></label><input type="text" id="tsd-search-field" aria-label="Search"/></div><div class="field"><div id="tsd-toolbar-links"></div></div><ul class="results"><li class="state loading">Preparing search index...</li><li class="state failure">The search index is not available</li></ul><a href="index.html" class="title">@ryandur/sand</a></div><div class="table-cell" id="tsd-widgets"><a href="#" class="tsd-widget tsd-toolbar-icon menu no-caption" data-toggle="menu" aria-label="Menu"><svg width="16" height="16" viewBox="0 0 16 16" fill="none"><use href="assets/icons.svg#icon-menu"></use></svg></a></div></div></header><div class="container container-main"><div class="col-content"><div class="tsd-page-title"><h2>@ryandur/sand</h2></div><div class="tsd-panel tsd-typography"><a id="md:sand" class="tsd-anchor"></a><h1><a href="#md:sand">Sand</a></h1><p>A library should support your decisions while allowing you to leave an impression for others to follow.</p>
<p>I made this little library of helper functions to aid my development of javascript/typescript applications and learn
more about the functional paradigm.</p>
<p><a href="https://ryandur.github.io/sand/modules.html">Docs</a></p>
<p><img src="./badges/coverage-branches.svg" alt="branches">  <img src="./badges/coverage-functions.svg" alt="Functions">  <img src="./badges/coverage-lines.svg" alt="lines">  <img src="./badges/coverage-statements.svg" alt="statements"></p>
<a id="md:maybe-how-you-would-like-to-use-it" class="tsd-anchor"></a><h2><a href="#md:maybe-how-you-would-like-to-use-it">Maybe how you would like to use it.</a></h2><p>Let&#39;s look at how we might use this lib. Imagine we are creating an
art <a href="https://peaceful-heyrovsky-96583c.netlify.app/gallery?page=1&size=8&tab=aic">gallery</a>, and we want to take a closer
look at one of the pieces. To get the piece of art we send a request to a backend referencing it by id. The response
might take a little while, so we need a way to notify the user that the request is pending. Once we have
obtained the piece we will need to display it, or if the call has failed we need to notify that something went wrong.</p>
<p>In the example below we request the art via ID. While we wait, we notify the user that the content is loading. The
<em><strong>onPending</strong></em> function will fire the provided callback twice. Once when it is invoked and again once the call is done,
passing the pending state <em>(true then false)</em> as a parameter. Once the call is complete it will invoke either
<em><strong>onSuccess</strong></em> with the data or <em><strong>onFailure</strong></em> with a possible explanation.</p>
<pre><code class="language-typescript"><span class="hl-0">getArt</span><span class="hl-1">(</span><span class="hl-2">id</span><span class="hl-1">)</span><br/><span class="hl-1">    .</span><span class="hl-0">onPending</span><span class="hl-1">(</span><span class="hl-2">isLoading</span><span class="hl-1">)</span><br/><span class="hl-1">    .</span><span class="hl-0">onSuccess</span><span class="hl-1">(</span><span class="hl-2">updatePiece</span><span class="hl-1">)</span><br/><span class="hl-1">    .</span><span class="hl-0">onFailure</span><span class="hl-1">(</span><span class="hl-2">hasErrored</span><span class="hl-1">);</span>
</code><button>Copy</button></pre>
<p>To handle the request, we make a http <em><strong>GET</strong></em> to the endpoint with the id. We validate the response, if the response
is structured correctly pass back the successful response, else pass back a failure with some explanation.</p>
<pre><code class="language-typescript"><span class="hl-3">const</span><span class="hl-1"> </span><span class="hl-4">failure</span><span class="hl-1"> = </span><span class="hl-2">asyncResult</span><span class="hl-1">.</span><span class="hl-2">failure</span><br/><br/><span class="hl-5">getArt</span><span class="hl-1">: (</span><span class="hl-2">id</span><span class="hl-1">: </span><span class="hl-6">string</span><span class="hl-1">): </span><span class="hl-6">Result</span><span class="hl-1">.</span><span class="hl-6">Async</span><span class="hl-1">&lt;</span><span class="hl-6">Art</span><span class="hl-1">, </span><span class="hl-6">Explanation</span><span class="hl-1">&lt;</span><span class="hl-6">HTTPError</span><span class="hl-1">&gt;&gt; </span><span class="hl-3">=&gt;</span><br/><span class="hl-1">    </span><span class="hl-2">http</span><span class="hl-1">.</span><span class="hl-0">get</span><span class="hl-1">(</span><span class="hl-7">`/some-endpoint/</span><span class="hl-3">${</span><span class="hl-2">id</span><span class="hl-3">}</span><span class="hl-7">`</span><span class="hl-1">)</span><br/><span class="hl-1">        .</span><span class="hl-0">mBind</span><span class="hl-1">(</span><span class="hl-2">response</span><span class="hl-1"> </span><span class="hl-3">=&gt;</span><span class="hl-1"> </span><span class="hl-0">maybe</span><span class="hl-1">(</span><span class="hl-0">valid</span><span class="hl-1">(</span><span class="hl-2">response</span><span class="hl-1">))</span><br/><span class="hl-1">            .</span><span class="hl-0">map</span><span class="hl-1">(</span><span class="hl-2">asyncResult</span><span class="hl-1">.</span><span class="hl-2">success</span><span class="hl-1">)</span><br/><span class="hl-1">            .</span><span class="hl-0">orElse</span><span class="hl-1">(</span><span class="hl-0">failure</span><span class="hl-1">({</span><span class="hl-2">type:</span><span class="hl-1"> </span><span class="hl-2">HTTPError</span><span class="hl-1">.</span><span class="hl-4">CANNOT_DECODE</span><span class="hl-1">, </span><span class="hl-2">cause:</span><span class="hl-1"> </span><span class="hl-2">response</span><span class="hl-1">})))</span>
</code><button>Copy</button></pre>
<p>To make the request, we fetch from the endpoint. If there is some kind of network error we give back an explanation. If
successful, we check the response status. Since it&#39;s a <em><strong>GET</strong></em> we expect a 200 is a successful response, or we
consider it a failure. Then we get the <em><strong>JSON</strong></em> out of the response. If there is a problem with the <em><strong>JSON</strong></em> we pack
it into an explanation.</p>
<pre><code class="language-typescript"><span class="hl-8">import</span><span class="hl-1"> {</span><span class="hl-2">asyncResult</span><span class="hl-1">} </span><span class="hl-8">from</span><span class="hl-1"> </span><span class="hl-7">&quot;./asyncResult&quot;</span><span class="hl-1">;</span><br/><span class="hl-3">const</span><span class="hl-1"> </span><span class="hl-4">failure</span><span class="hl-1"> = </span><span class="hl-2">asyncResult</span><span class="hl-1">.</span><span class="hl-2">failure</span><br/><br/><span class="hl-5">get</span><span class="hl-1">: (</span><span class="hl-2">endpoint</span><span class="hl-1">: </span><span class="hl-6">string</span><span class="hl-1">): </span><span class="hl-6">Result</span><span class="hl-1">.</span><span class="hl-6">Async</span><span class="hl-1">&lt;</span><span class="hl-6">Art</span><span class="hl-1">, </span><span class="hl-6">Explanation</span><span class="hl-1">&lt;</span><span class="hl-6">HTTPError</span><span class="hl-1">&gt;&gt; </span><span class="hl-3">=&gt;</span><br/><span class="hl-1">    </span><span class="hl-2">asyncResult</span><span class="hl-1">.</span><span class="hl-0">of</span><span class="hl-1">(</span><span class="hl-0">fetch</span><span class="hl-1">(</span><span class="hl-2">endpoint</span><span class="hl-1">))</span><br/><span class="hl-1">        .</span><span class="hl-0">or</span><span class="hl-1">(</span><span class="hl-2">err</span><span class="hl-1"> </span><span class="hl-3">=&gt;</span><span class="hl-1"> </span><span class="hl-0">failure</span><span class="hl-1">({</span><span class="hl-2">type:</span><span class="hl-1"> </span><span class="hl-2">HTTPError</span><span class="hl-1">.</span><span class="hl-4">NETWORK_ERROR</span><span class="hl-1">, </span><span class="hl-2">cause:</span><span class="hl-1"> </span><span class="hl-2">err</span><span class="hl-1">}))</span><br/><span class="hl-1">        .</span><span class="hl-0">mBind</span><span class="hl-1">(</span><span class="hl-2">response</span><span class="hl-1"> </span><span class="hl-3">=&gt;</span><span class="hl-1"> </span><span class="hl-2">response</span><span class="hl-1">.</span><span class="hl-2">status</span><span class="hl-1"> === </span><span class="hl-2">HTTPStatus</span><span class="hl-1">.</span><span class="hl-4">OK</span><span class="hl-1"> ? </span><br/><span class="hl-1">            </span><span class="hl-2">asyncResult</span><span class="hl-1">.</span><span class="hl-0">of</span><span class="hl-1">(</span><span class="hl-2">response</span><span class="hl-1">.</span><span class="hl-0">json</span><span class="hl-1">()) : </span><br/><span class="hl-1">            </span><span class="hl-0">failure</span><span class="hl-1">({</span><span class="hl-2">type:</span><span class="hl-1"> </span><span class="hl-2">HTTPError</span><span class="hl-1">.</span><span class="hl-4">NOT_OK</span><span class="hl-1">, </span><span class="hl-2">cause:</span><span class="hl-1"> </span><span class="hl-2">response</span><span class="hl-1">}));</span>
</code><button>Copy</button></pre>
<a id="md:examples-of-use" class="tsd-anchor"></a><h2><a href="#md:examples-of-use">Examples of use</a></h2><p><a href="https://peaceful-heyrovsky-96583c.netlify.app/gallery?page=1&size=8&tab=aic">Art Gallery</a></p>
<ul>
<li><a href="https://github.com/RyanDur/ChosenPicachu/blob/main/src/components/Gallery/Art/index.tsx#L19">Art</a></li>
<li><a href="https://github.com/RyanDur/ChosenPicachu/blob/main/src/components/Gallery/ArtPiece/index.tsx#L19">ArtPiece</a></li>
<li><a href="https://github.com/RyanDur/ChosenPicachu/blob/main/src/data/artGallery/index.ts#L11">handle request</a></li>
<li><a href="https://github.com/RyanDur/ChosenPicachu/blob/main/src/data/http.ts#L24">make request</a></li>
</ul>
<a id="md:resources" class="tsd-anchor"></a><h2><a href="#md:resources">Resources</a></h2><ul>
<li><a href="https://fsharpforfunandprofit.com/rop/">Railway Oriented Programming</a></li>
<li><a href="https://haskellbook.com/">Haskell Programming from First Principles</a></li>
<li><a href="https://github.com/dam5s/react-redux-starter/tree/main/src/prelude">React Redux Starter - ../prelude</a></li>
</ul>
</div></div><div class="col-sidebar"><div class="page-menu"><div class="tsd-navigation settings"><details class="tsd-index-accordion"><summary class="tsd-accordion-summary"><h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none"><use href="assets/icons.svg#icon-chevronDown"></use></svg>Settings</h3></summary><div class="tsd-accordion-details"><div class="tsd-filter-visibility"><h4 class="uppercase">Member Visibility</h4><form><ul id="tsd-filter-options"><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-protected" name="protected"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Protected</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-private" name="private"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Private</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-inherited" name="inherited" checked/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Inherited</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-external" name="external"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>External</span></label></li></ul></form></div><div class="tsd-theme-toggle"><h4 class="uppercase">Theme</h4><select id="tsd-theme"><option value="os">OS</option><option value="light">Light</option><option value="dark">Dark</option></select></div></div></details></div><details open class="tsd-index-accordion tsd-page-navigation"><summary class="tsd-accordion-summary"><h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none"><use href="assets/icons.svg#icon-chevronDown"></use></svg>On This Page</h3></summary><div class="tsd-accordion-details"><a href="#md:sand"><span>Sand</span></a><ul><li><a href="#md:maybe-how-you-would-like-to-use-it"><span>Maybe how you would like to use it.</span></a></li><li><a href="#md:examples-of-use"><span>Examples of use</span></a></li><li><a href="#md:resources"><span>Resources</span></a></li></ul></div></details></div><div class="site-menu"><nav class="tsd-navigation"><a href="modules.html" class="current"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="assets/icons.svg#icon-1"></use></svg><span>@ryandur/sand</span></a><ul class="tsd-small-nested-navigation" id="tsd-nav-container" data-base="."><li>Loading...</li></ul></nav></div></div></div><div class="tsd-generator"><p>Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a></p></div><div class="overlay"></div></body></html>